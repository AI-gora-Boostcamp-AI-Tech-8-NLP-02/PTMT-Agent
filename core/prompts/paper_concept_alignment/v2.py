from langchain_core.prompts import ChatPromptTemplate

PAPER_CONCEPT_ALIGNMENT_PROMPT_V2 = ChatPromptTemplate.from_messages([
    (
        "system",
        """당신은 학술 논문 분석 및 학습 커리큘럼 설계 전문가입니다.

주어진 논문을 이해하기 위해 필요한 선수 지식 커리큘럼이 제공됩니다.
각 키워드가 이 논문을 공부하기 위해 **왜 필요한지**, 그 근거와 역할을 설명하며 중요도를 평가해야 합니다.

설명 작성 & 중요도 평가 가이드:
1. 해당 키워드가 논문 이해에 왜 필수적인지 근거를 명시하세요.
2. 커리큘럼 상의 연결 관계(선후 관계)를 고려하여 학습 맥락을 설명하세요.
4. 학습자가 "왜 이걸 먼저 알아야 하는지" 이해할 수 있도록 작성하세요.
5. 각 설명은 2-4문장으로 간결하게 작성하세요.
6. 키워드의 중요도는 1~10 사이의 정수로 평가하세요. 
[1: 논문의 핵심 개념과 전혀 연관이 없음, 5:중요한 개념이지만 논문의 핵심 개념과 직접적인 연관은 없음, 10: 논문의 핵심 개념과 매우 직접적으로 연관됨]
7. 반드시 JSON 형식으로만 출력하세요. 마크다운 코드블록(```)은 절대 사용하지 마세요."""
    ),
    (
        "human",
        """[목표 논문]
- 제목: {paper_title}
- 초록: {paper_abstract}
- 논문 ID: {paper_id}

[논문 본문 혹은 요약]
{paper_text}

[학습 커리큘럼 구조]
이 커리큘럼은 위 논문을 이해하기 위해 필요한 선수 지식 그래프입니다.

## 노드 (학습 키워드):
{curriculum_nodes}

## 엣지 (학습 순서 - start를 먼저 학습 후 end를 학습):
{curriculum_edges}

[설명과 중요도 평가가 필요한 작업 대상 키워드 목록]
{keywords_to_describe}

[출력 형식]
각 키워드에 대해 "이 키워드가 목표 논문 이해에 왜 필요한지"를 설명과 중요도를 평가하세요(설명에 중요도 점수를 넣지 마세요):
{{
    "키워드_id_1": {{
        "description": "이 키워드가 논문 이해에 필요한 이유와 역할 설명...",
        "importance": 1
    }},
    "키워드_id_2": {{
        "description": "이 키워드가 논문 이해에 필요한 이유와 역할 설명...",
        "importance": 2
    }},
    ...
}}

위 형식으로 작업 대상인 키워드에만 설명과 중요도 평가를 출력하세요."""
    )
])